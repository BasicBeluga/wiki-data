
Az utasok és a rakományok szétosztása korábban a CargoDist nevű patch használatával volt lehetséges. A patch 2013. júniusától az OpenTTD [[hu/Nightly|nightly]], majd a 2013. karácsonyán kiadott 1.4.0 béta verziója részévé vált, így a [[hu/Haladó beállítok|Haladó beállítások]] használatával elérhető az a lehetőség, hogy a játék az utasok, a levelek és minden más rakomány számára célállomást határozzon meg. A rakomány csak a célállomása felé tartó járműre kerül fel.



==Áttekintés==

A klasszikus OpenTTD-ben nehéz az állomáson felhalmozódó rakományt szétosztani több állomás közt: vagy több járművet kell használni eltérő utasításlistával, vagy bonyolult utasításlistát kell összeállítani.

Tegyük fel, hogy van egy vonatunk, mely "A" és "B" város közt ingázik. A vasútállomáshoz mindkét városban több buszmegállóból álló buszhálózat kapcsolódik. Szándékod szerint az utasok "A" város bármely buszmegállójából utazhatnának "B" város bármely buszmegállójáig, és viszont. Az OpenTTD hagyományos használatával "A" városban buszokkal szállíthatod az utasokat a vasútállomásra, ahol aztán egy vonat veszi fel őket és szállítja tovább "B" város vasútállomására, ahol pedig "B" város buszai osztják szét őket a buszmegállók közt úgy, hogy a vasútállomás és az egyes buszmegállók közt csillag formában oda-vissza ingáznak. Minden egyes jármű utasításlistája "Elszállítás és üresen indulás" utasítást tartalmaz, a kiegészítő útvonalakon bonyolultabb utasításlista is használható. Ez a megoldás még nem teszi lehetővé, hogy az utasok A-ból B-be akarjanak jutni, vagy az egyik város valamelyik vasútállomására vagy valamelyik buszmegállójába. Minél több állomást és járművet adsz hozzá, annál bonyolultabb és nehézkesebb rendszert eredményez.

A '''rakományok szétosztása''' automatikusan gondoskodik az elszállításról, és kiválasztja az érintett utasok célállomását. A fenti példában nem kell egyetlen "Elszállítás és üresen indulás" utasítást sem meghatároznod, és nem kell csillag formájú buszhálózatot sem összeállítanod. Az utasok tudják, hová utaznak és melyik járműre szálljanak fel, elképzelhető, hogy emiatt több várakozó utast találsz az állomásokon.

A rakomány szétosztására választott CargoDist mellett más patch-ek is hasonló hatást próbálnak elérni. A [[hu/Cargodest|Cargod'''e'''st]]-tel szemben a CargoDist az rakomány útvonalának meghatározását és a különböző útvonalak terhelésének kiegyensúlyozását együtt oldja meg, a szállítási igényt pedig ezek előfeltételeként kezeli. A [http://www.tt-forums.net/viewtopic.php?f=33&t=54253 YACD]-től pedig abban tér el a CargoDist hogy elérhető úticélokat vesz figyelembe, nem pedig az egész terepet, másfelől pedig -- a számítógép teljesítményére tekintettel -- a teljes útvonal-rendszert külön szálon előszámítja.

Az [http://www.tt-forums.net/viewtopic.php?f=33&t=41992&start=0 angol nyelvű fórum-topikban] további tájékoztatás olvasható. Ha a rakomány szétosztásához kapcsolódóan további kérdéseid lennének, tedd ott fel bátran.


==Működési módok==
[[File:en/Manual/Cargodist-overlays.png|frame|Rakományáramlási térkép és jelmagyarázat]]
[[File:en/Manual/Cargodist-station.png|frame|Megváltozott állomás-ablak]]

A CardoDist-tel az utasok és a rakományok szétosztására három módot kapsz. A Haladó beállításoknál meghatározhatod, hogy a rakomány különböző típusaira melyiket akarod alkalmazni. 
* A '''kézi''' szétosztás azt jelenti, hogy nincs automatikus szétosztás, tehát a játék úgy működik, mint a CargoDist nélkül.
* A '''szimmetrikus''' szétosztással az algoritmus két célállomás közt azonos mértékben próbálja meg szétosztani a rakományt. Ez nem mindig sikerül. Ha van olyan állomás, ahol több utas gyűlik össze, mint a szóba jöhető többi állomáson összesen, azokra nyilván nem osztható szét a rakomány egyenletesen. Az algoritmus következetességét befolyásolhatod a ''Szimmetrikus esetben a visszatérő rakomány mennyisége'' opció beállításával. Ha 100%-nál kisebbre állítod, az egyik irányba kevesebb rakomány indul, mint a másik irányba.
* Az ''aszimmetrikus'' szétosztással ilyen korlátozások nélkül kerül a rakomány szétosztásra.

==Kiegészítések a világtérképhez és a főablakhoz==

A rakomány áramlásának áttekintéséhez úgy a főablak, mint a világtérkép segítséget nyújt az állomások és szállítási kapcsolatok feltüntetésével. A kapcsolatok vonalként jelennek meg a szállítási útvonal kapacitásától függő színekkel. A sárga és a vörös akkor jelenik meg, ha a rakomány szétosztását az adott rakományra engedélyeztük, és a rakományáramlás-számítás szerint a szállítható rakományhoz túl kicsi a szállítási kapacitás az adott viszonylatban. A fehér és a világoszöld azt jelzi, hogy a szállítható rakományra túl nagy a szállítási kapacitás. Ilyen esetben néhány járművet kivonhatsz a forgalomból, vagy meg lehet határozni olyan szállítási kapcsolatot is, hogy a járművek a rakomány célba juttatása után üresen térjenek vissza. 

Az állomásokat a cég színének megfelelő színű négyzetek jelölik. Minél több utas vagy rakomány érkezik az állomásra vagy termelődik ott, annál nagyobb a négyzet. A főablak rakományáramlási magyarázata a '''Térkép''' menüből nyitható meg. Kijelölheted, hogy a főablak melyik játékosok milyen rakományainak kapcsolatát jelenítse meg. A rakományáramlási világtérkép csak a saját cég kapcsolatait mutatja. A menüben új almenü szolgál a megjelenítendő rakomány kiválasztására.

==Az állomásablak kiterjesztése==
Az állomásablakban látható, csoportosítható és rendezhető az állomáson tartózkodó, vagy oda tervezett rakomány mennyisége, származási helye, következő átszállítási állomása, valamint becsült végcélja szerint. A rakomány végcélja csak becsült, ne várd tehát, hogy a rakomány minden egysége pontosan oda fog érkezni. A program a feltüntetett rakománykötegeket az útvonaltervezés miatt nem, de a járművek eltérő mérete miatt megbonthatja. A becsült cél pontossága vonatkozásában tehát nehéz lenne itt pontos számokat mondani. Hosszútávon viszont minden a legmegfelelőbb állomásra jut.

A lenyíló menü használatával megadott szempontoknak megfelelően, az állomások vagy a rakomány mennyisége szerint csoportosított és sorba rendezett csoportokat a sor végén található kis "+" vagy "-" jelre kattintva alcsoportokra lehet kifejteni és vissza lehet zárni. A csoportokat és alcsoportokat sorba is rendezheted a rakomány mennyisége vagy az állomások kiválasztott rendje szerint.

==Haladó beállítások==

Ha a rakomány szétosztását valamelyik rakományfajtára bekapcsoljuk, néhány játéknapnak el kell telnie, amíg az automatikus szétosztás megkezdődik. A szétosztást a program időszakonként újraszámolja, így a rakomány szétosztása az első számítás elvégzése után kezdődik. A számítás a kapcsolati gráfokra alapul. A kapcsolati gráf a szállítási hálózatod adott rakományához kapcsolódó elem. A bevezető példában "A" és "B" város összes állomása és buszmegállója alkot egy kapcsolati gráfot. Ha egy harmadik, "C" városban is van egy buszhálózatod, ami nincs kapcsolatban sem "A", sem "B" várossal, külön kapcsolati gráfot alkot. Minél több kapcsolati gráf van egy játékban, annál tovább tart azok kiszámítása.

A '''Haladó beállítások''' ''Rakományok szétosztása'' csoportjában befolyásolhatod, milyen gyakorisággal induljon, és mennyi ideig tartson az egyes kapcsolati gráfok számítása. Ez közvetve meghatározza az egyidejűleg végezhető kapcsolati gráfszámítások számát. A kapcsolati gráfok számítása a játéktól független, külön szálakon fut. Ezek a szálak előre meghatározott rendszerességgel kapcsolódnak a játékhoz a hálózat összehangolása érdekében. A rendszeresség és az időtartam a legtöbb számítógépes játék esetében a legtöbb számítógépen valamelyest csökkenthető annak érdekében, hogy a parancsok és a végrehajtásuk közti idő rövidebbé váljon. Ha túl alacsonyra állítod ezeket az értékeket, előfordulhat, hogy a játék lelassul, mert a kapcsolati gráfok számításának befejezését várja. Ha az alapértelmezett értékeket használod, ez nem fordulhat elő, mert azokat lassú számítógépen futó kivételesen nagy játékokra szabtuk. A szétosztás pontosságát egy további beállítás is befolyásolja. Minél pontosabb egy gráfszámítás, annál tovább tart. Ezért, ha ezt a beállítást megváltoztatod, ellensúlyozd az időtartam megváltoztatásával.

A ''Távolság hatása a küldött mennyiségre'' beállítás a közeli és a távoli állomásokra küldött rakomány arányát határozza meg. Megváltoztatását nem javasoljuk, csak hibakeresés esetére.

==Korlátozások==

A Cargodist nem veszi figyelembe a "Teljes kirakodás", az "Elszállítás", a "Nincs kirakodás" és a "Nincs berakodás" utasításokat a kapcsolati gráf létrehozásakor. A '''"Berakodás, ha lehetséges"''' és a '''"Kirakodás, ha lehetséges"''' utasításokat jól kezeli, és ért '''minden "Via"''' utasítást (minthogy figyelmen kívül hagyja). Minden egyéb "Teljes kirakodás", "Elszállítás", "Nincs kirakodás", vagy "Nincs berakodás" utasítás ahhoz vezethet, hogy a rakományt ki-vagy berakodásra tervezi az utasításban szereplő állomáson még akkor is, ha valójában ez nem következhet be a szóban forgó be- vagy kirakodási utasítás miatt. Ezek az utasítások a kapcsolati gráfokban elvileg kezelhetők, de ennek megvalósítása külön nagy projekt lenne, a játékra gyakorolt csekély hatása miatt a kivitelezését nem tervezzük.

A ''feltételes utasítások'' fogalmilag problemtatikusak. A kapcsolati gráf számára [http://hu.wikipedia.org/wiki/Matematikai_probl%C3%A9ma eldönthetetlen problémát] okozhat a jármű berakodás mértékétől függő utasítása, más feltételek eredményét pedig nagyon nehéz előre megjósolni a bekövetkezésükkor várható állapotig tartó szimuláció nélkül. 
Conditional orders are problematic by definition. You can create an [http://en.wikipedia.org/wiki/Undecidable_problem undecidable problem] for the link graph creation algorithm by having a vehicle's orders depend on load percentage. The shape of the link graph determines which cargo a vehicle will load. The cargo loaded then determines which way it goes and that in turn determines the shape of the link graph. Some of the other conditions' outcomes are very hard to predict in advance without simulating the whole game up to the point when they are to be evaluated normally. The link graph creation and cargo routing algorithms handle that pragmatically and assume that most conditions will just yield the same result when they are evaluated for link graph creation or cargo loading and for vehicle routing. This does not work for load percentage conditions that have to be evaluated in order to decide which cargo to load. Those are evaluated based on cargo available at the station where the vehicle is loading. The condition is evaluated so that the vehicle can load the most cargo available at the station when assumed to take the same decision about the conditional order later on. An example for a problematic order configuration is this:

 Go to LOADING STATION
 Go to DROP1
 If load percentage equals 0 go to LOADING STATION
 Go to DROP2
 If load percentage equals 0 go to LOADING STATION
 Go to DROP3

It's a nice idea but obviously any vehicle following those orders could either decide to transfer all its cargo at DROP1 and return to LOADING STATION or it could keep the cargo going via DROP2 and go on. Both is correct. Thus, if you construct order systems like that, you'll see a lot of random and seemingly pointless loading and unloading at DROP1 and DROP2 as vehicles can't decide what to do.