This article gets you started on compiling OpenTTD using Microsoft Visual C++ 2005 Express Edition.

==Required software==
Download these pieces of software.  Then follow the installation instructions provided in this article.
#[http://msdn.microsoft.com/vstudio/express/visualc/download/ Microsoft Visual C++ 2005 Express Edition]
#[http://www.microsoft.com/downloads/details.aspx?FamilyId=0BAF2B35-C656-4969-ACE8-E4C0C0716ADB&displaylang=en Microsoft Platform SDK]
#[http://www.microsoft.com/downloads/details.aspx?FamilyID=4b78a58a-e672-4b83-a28e-72b5e93bd60a&DisplayLang=en Microsoft DirectX SDK]
#[http://sourceforge.net/project/showfiles.php?group_id=103924&package_id=114307 Openttd-useful.zip], a collection of files of varying age. 
#[http://tortoisesvn.net/downloads TortoiseSVN]
#The newest source from <code>svn://svn.openttd.org/trunk</code>; download with TortoiseSVN.

Note: This guide has been made on Windows XP with VTP applied. There are known problems with the DirectX & Platform SDKs on Windows 2000, and nothing is known about Windows Vista. Use it at your own risk!

===Alternative files===
For the latest zlib, libpng and FreeType files you can browse their websites below.
* [http://www.zlib.net/ zlib]
* [http://sourceforge.net/project/showfiles.php?group_id=23617&package_id=16183 GnuWin32 libpng]
* [http://gnuwin32.sourceforge.net/downlinks/freetype.php GnuWin32 FreeType]


TortoiseSVN is great for SVN novices, some advanced developers prefer the command line SVN client:
*[http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91  Subversion 1.3.2 Win32 binaries]

==Installation and setup==

* Install Microsoft Visual C++ 2005 Express Edition. This should be fairly easy. Download it, run it and drink a beer while waiting ;)
* Install Microsoft Platform SDK. I recommend to install the same options way I did, so it won't use a lot of unnecessary space (see the images below).

[[File:en/Archive/Compilation and Ports/Psdk custom1.png]]

[[File:en/Archive/Compilation and Ports/Psdk custom2.png]]

===Setting up includes and libraries===

Now extract the [http://sourceforge.net/project/showfiles.php?group_id=103924&package_id=114307 Openttd-useful.zip] file and copy:

* The contents of the <code>include</code> folder and [http://www-d0.fnal.gov/d0dist/dist/packages/d0ve/devel/windows/AFXRES.H afxres.h] to <code>C:\Program Files\Microsoft Visual Studio 8\VC\include</code>.

* The contents of the <code>library</code> folder to <code>C:\Program Files\Microsoft Visual Studio 8\VC\lib</code>.

===Setting up the DirectX SDK===

Well, from the components screen remove the documentation and sample source code you'll save a lot of space (800+ MB). They're pretty useless if you just need to compile OpenTTD. 
'''Note:'''You should not use a version newer then August 2007 as DirectMusic is no longer support as of the November 2007 release.

===Setting up the VC++ Directories===

Go to <code>Tools -> Options</code>, then to <code>Projects and Solutions -> VC++ Directories</code>. Add the following lines:

Executable files:
* C:\Program Files\Microsoft Platform SDK\Bin

Include files:
* C:\Program Files\Microsoft Platform SDK\Include
* C:\Program Files\Microsoft DirectX SDK\Include

Library files:
* C:\Program Files\Microsoft DirectX SDK\Lib\x86
* C:\Program Files\Microsoft Platform SDK\Lib

'''Note:''' Please update the paths as necessary.


[[File:en/Archive/Compilation and Ports/Msvc exe screen.png]]

[[File:en/Archive/Compilation and Ports/Msvc include screen.png]]

[[File:en/Archive/Compilation and Ports/Msvc lib screen.png]]


Only a few changes are required to use the Platform SDK with Visual C++ 2005 Express. Please follow steps 3, 4 and maybe 5 of [http://web.archive.org/web/20070103142356/http://msdn.microsoft.com/vstudio/express/visualc/usingpsdk/ the guide from Microsoft].

==Compiling==

Open <code>projects/openttd_vs80.sln</code>. This will open your IDE with the project loaded. If you want to compile a debug version straight ahead, press <code>F7</code> and enjoy. To compile a non-debug version, go to <code>Build -> Configuration Manager</code> and select <code>Release for OpenTTD</code>. Press <code>F7</code>.

[[Category:en/Development/Compiling OpenTTD]]
[[Category:en/Development/Microsoft Visual C++]]
[[Category:en/Archive/Program Descriptions]]