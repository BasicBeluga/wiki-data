This article gets you started on compiling OpenTTD using Microsoft Visual C++ 2008 Express Editions.

=Required software=
:* [http://www.microsoft.com/express/download/default.aspx Microsoft® Visual C++ 2008 Express Editions] ''(current: Final)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=529f03be-1339-48c4-bd5a-8506e5acf571 Microsoft® DirectX SDK - August 2007 or earlier] ''(needed for DirectMusic, more later)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=ea4894b5-e98d-44f6-842d-e32147237638&DisplayLang=en Microsoft® DirectX SDK - November 2007 or later] ''(current: November 2008)''


:* [http://binaries.openttd.org/extra/openttd-useful/ Openttd-useful.zip]
:** openttd_useful.zip is a collection of files of varying age. For the latest zlib, libpng and FreeType files you can browse their websites below.
:** [http://www.zlib.net/ zlib]
:** [http://sourceforge.net/project/showfiles.php?group_id=23617&package_id=16183 GnuWin32 libpng]
:** [http://gnuwin32.sourceforge.net/downlinks/freetype.php GnuWin32 FreeType]
:** [http://icu-project.org/download/ ICU4C]

:...and of course the newest source from <code>svn://svn.openttd.org/trunk</code>. You need to have a SVN-client to download the source from the SVN server. Pick either of the following two. For SVN novices TortoiseSVN is highly recommended:

:* [http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91 Command line version] ''(Subversion 1.4.5 Win32 binaries)''
:* [http://tortoisesvn.net/downloads GUI TortoiseSVN]


:'''Note:''' This guide has been made on Windows Vista 32bit.

=Installing=

===Microsoft® Visual C++ 2008 Express Editions===
:If you just need to compile OpenTTD it's enough if you don't select any options (see the image below).

:[[File:en/Archive/Compilation and Ports/Microsoft Visual Cpp 2008 Express Editions.png]]

===Microsoft® DirectX SDK===
:'''Install the version November 2007 or later'''
:From the components screen remove the documentation and sample source code you'll save a lot of space. They're pretty useless if you just need to compile OpenTTD (see the image below).

:[[File:en/Microsoft DirectX SDK.png]]

=Copying from OpenTTD needed includes and libraries=
===openttd_useful.zip===
:*Extract the [http://binaries.openttd.org/extra/openttd-useful/ Openttd-useful.zip] file and copy the content to some <code><personal folder></code>.
:*Now you need to tell Visual C++ where the files are located. Navigate to ''Tools > Options > Projects and Solutions > VC++ Directories'':<br />
:**Select Platform '''Win32''' (Be sure that all your entries are '''before''' any SDK folder!):
:***Select '''Include Files''', press the new folder button and add the folder <code><personal folder>\shared\include</code> to the list.
:***Select '''Library Files''', press the new folder button and add the folder <code><personal folder>\win32\library</code> to the list.
:**Select Platform '''x64''' (Skip if it isn't available! Again be sure that all your entries are '''before''' any SDK folder!) :
:***Select '''Include Files''', press the new folder button and add the folder <code><personal folder>\shared\include</code> to the list.
:***Select '''Library Files''', press the new folder button and add the folder <code><personal folder>\win64\library</code> to the list.<br />

:Don't forget to replace <code><personal folder></code> with the folder where you extracted openttd-useful.zip.

===Microsoft® DirectX SDK - August 2007===
: '''Information''': The DirectX SDK from November 2007 is the first one which supports Microsoft® Visual Studio 2008. But it's also the first version which doesn't support DirectMusic which is needed to compile OpenTTD. That is why we must copy the missing files from an older version, preferably the final one for DirectMusic: 'August 2007'.
:* Extract ('''no double-click, do not install''') <code>dxsdk_aug2007.exe</code> in an extra directory and you get a file called <code>dxsdk_aug2007.exe</code> (yes that's right, both files have the same name).
:* Extract the second <code>dxsdk_aug2007.exe</code> in an extra directory.
:* Now copy following 9 files from <code>.\dxsdk_aug2007\dxsdk_aug2007\include\</code> to <code><personal folder>\include\</code> ('''note''': Please replace <code><personal folder></code> with the folder which you added to the VC++ Directories before):
:** <code>dls1.h</code>
:** <code>dmdls.h</code>
:** <code>dmerror.h</code>
:** <code>dmksctrl.h</code>
:** <code>dmplugin.h</code>
:** <code>dmusbuff.h</code>
:** <code>dmusicc.h</code>
:** <code>dmusicf.h</code>
:** <code>dmusici.h</code>
:* You also have to copy 2 files from <code>.\dxsdk_aug2007\dxsdk_aug2007\lib\</code> to <code><personal folder>\library\</code> to avoid linker errors with newer dxguid.lib's without DirectMusic support:
:** <code>\x86\dxguid.lib</code>
:** <code>\x64\dxguid.lib</code>

: '''Alternative''': If you are willing to compile without support for MIDI music you will not be needing the older DirectX SDK. To disable music, remove the WIN32_ENABLE_DIRECTMUSIC_SUPPORT preprocessor definition from the openttd project using the project properties dialog.

=Compiling=
:* Open <code>projects/openttd_vs90.sln</code>. This will open your IDE with the project loaded.
:* To compile a non-debug version, go to <code>Build -> Configuration Manager</code> and select <code>Release for OpenTTD</code>.
:* Add the DirectX headers subdirectory through the openttd project properties -> C/C++ -> General -> Additional Include Directories
:* Add the DirectX SDK Lib subdirectory through the openttd project properties -> Linker -> General -> Additional Library Directories
:* Copy the data folder from your normal OpenTTD installation directory, typically <code>C:/Program Files/OpenTDD</code>, and paste the folder into <code>objs/Win32/Debug</code>.
:* Press <code>F7</code>, or go to <code>Build -> Build Solution</code>.

=Credits=

:* OpenTTD Developers for the great game.
:* Microsoft® for the the SDKs and Visual C++ 2008 Express Edition.
:* Sebastian and Desolator (aka Mircea Chirea) for creating/updating the Microsoft® Visual C++ 2005 Express guide.

[[Category:en/Development]]
[[Category:en/Development/Compiling OpenTTD]]
[[Category:en/Development/Microsoft Visual C++]]
[[Category:en/Archive/Program Descriptions]]