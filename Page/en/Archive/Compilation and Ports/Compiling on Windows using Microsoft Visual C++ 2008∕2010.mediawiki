This article gets you started on compiling OpenTTD using Microsoft Visual C++ 2008 Express Editions.

'''Under construction!'''

=Required software=
:* [http://msdn2.microsoft.com/de-de/express/future/bb421473.aspx Microsoft® Visual C++ 2008 Express Editions] ''(current: Beta 2)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=74dd6e2d-89c6-4e1e-af00-fc7d70f15439&DisplayLang=en Microsoft® Platform SDK] ''(current: 7/30/2007 "for Windows Server® 2008 and .NET Framework 3.5")''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=529f03be-1339-48c4-bd5a-8506e5acf571&DisplayLang=en Microsoft® DirectX SDK - August 2007 or earlier] ''(needed for DirectMusic, more later)''
:* [http://www.microsoft.com/downloads/details.aspx?FamilyID=4b78a58a-e672-4b83-a28e-72b5e93bd60a&DisplayLang=en Microsoft® DirectX SDK - November 2007 or later] ''(current: November 2007)''
:* Only for Windows® XP: [http://www.microsoft.com/downloads/details.aspx?FamilyId=10CC340B-F857-4A14-83F5-25634C3BF043&displaylang=en Microsoft® .NET Framework 3.0]


:* [http://www-d0.fnal.gov/d0dist/dist/packages/d0ve/devel/windows/AFXRES.H afxres.h]
:* [http://sourceforge.net/project/showfiles.php?group_id=103924&package_id=114307 Openttd-useful.zip]
:** openttd_useful.zip is a collection of files of varying age. For the latest zlib, libpng and FreeType files you can browse their websites below.
:** [http://www.zlib.net/ zlib]
:** [http://sourceforge.net/project/showfiles.php?group_id=23617&package_id=16183 GnuWin32 libpng]
:** [http://gnuwin32.sourceforge.net/downlinks/freetype.php GnuWin32 FreeType]


:...and of course the newest source from <code>svn://svn.openttd.org/trunk</code>. You have to have a SVN-client to download the source. Pick either of the following two. For SVN novices TortoiseSVN is highly recommended:

:* [http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91 Command line version] ''(Subversion 1.4.5 Win32 binaries)''
:* [http://tortoisesvn.tigris.org/download.html GUI TortoiseSVN]


:'''Note:''' This guide has been made on Windows Vista 32bit.

=Installing=
===Microsoft® .NET Framework 3.0===
:Only for Windows® XP: Simple install it.
:Windows® Vista® get it automatically with the Windows Update®. You should start it bevor continue.

===Microsoft® Visual C++ 2008 Express Editions===
:If you just need to compile OpenTTD it's enough if you select '''"Graphical IDE"''' (see the image below).

:[[File:en/Archive/Compilation and Ports/Microsoft Visual Cpp 2008 Express Editions.png]]

===Microsoft® Platform SDK===
:If you just need to compile OpenTTD I recommend to install the same options way I did, so it won't use a lot of unnecessary space (see the image below).

:[[File:en/Microsoft Platform SDK.png]]

===Microsoft® DirectX SDK===
:'''Install the version November 2007 or later'''
:From the components screen remove the documentation and sample source code you'll save a lot of space. They're pretty useless if you just need to compile OpenTTD (see the image below).

:[[File:en/Microsoft DirectX SDK.png]]

=Copying from OpenTTD needed includes and libraries=
:Now extract the [http://sourceforge.net/project/showfiles.php?group_id=103924&package_id=114307 Openttd-useful.zip] file and copy:
:* The contents of the <code>include</code> folder and [http://www-d0.fnal.gov/d0dist/dist/packages/d0ve/devel/windows/AFXRES.H afxres.h] to <code>C:\Program Files\Microsoft Visual Studio 9.0\VC\include\</code>.
:* The contents of the <code>library</code> folder to <code>C:\Program Files\Microsoft Visual Studio 9.0\VC\lib\</code>.

=Setting up the VC++ Directories=
:Start the Microsoft® Visual C++ IDE and go to <code>Tools -> Options</code>, then to <code>Projects and Solutions -> VC++ Directories</code>. Add the following lines ('''note''': Please update the paths as necessary):

===Executable files===
:* C:\Program Files\Microsoft SDKs\Windows\V6.1\Bin

:[[File:en/MSVC 9 config 1.png]]

===Include files===
:* C:\Program Files\Microsoft DirectX SDK (November 2007)\Include
:* C:\Program Files\Microsoft SDKs\Windows\V6.1\Include

:[[File:en/MSVC 9 config 2.png]]

===Libary files===
:* C:\Program Files\Microsoft DirectX SDK (November 2007)\Lib\x86
:* C:\Program Files\Microsoft SDKs\Windows\V6.1\Lib

:[[File:en/MSVC 9 config 3.png]]

=Compiling=
:* Open <code>projects/openttd_vs80.sln</code>. This will open your IDE with the project loaded.
:* You will ask to convert the old project file to the new version, do it. ''(This is still OpenTTD have an own project file for Visual C++ 2008)''
:* To compile a non-debug version, go to <code>Build -> Configuration Manager</code> and select <code>Release for OpenTTD</code>.
:* Press <code>F7</code>, or go to <code>Build -> Build Solution</code>.

=Credits=

* OpenTTD Developers for the great game.
* Microsoft® for the the SDKs and Visual C++ 2008 Express Edition.
* Sebastian and Desolator (aka Mircea Chirea) for creating/updating the Microsoft® Visual C++ 2005 Express guide.

[[Category:en/Development/Compiling OpenTTD]]
[[Category:en/Archive/Program Descriptions]]