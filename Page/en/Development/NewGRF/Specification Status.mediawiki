== OpenTTD 1.9 ==

{|
|-
!Feature!!NFO!!OpenTTD implementation!!NFO spec!!NML implementation!!NML spec!!OpenGFX implementation!!Eints implementation
|-
|OpenTTD NewGRF version for git||Variable 21/A1||done||done||N/A||done||N/A||N/A
|-
|rowspan=2|256 persistent registers
|VA2||done||done||done||done||N/A||N/A
|-
|PatchFlag 80||done||done||done||done||N/A||N/A
|-
|64 cargo types||Cargo Action 0/3||done||done||done||done||N/A||N/A
|-
|Airport animation trigger: AAT_STATION_AIRPLANE_LAND||AirTile property 11 flag 5||done||done??||done||done||N/A||N/A
|-
|64 rail types||Railtype Action 0/3||done||done||done||done||N/A||N/A
|-
|Hidden railtypes: RTF_HIDDEN||Railtype property 10 flag 2||done||done||done||done||N/A||N/A
|-
|More house input cargos||House property 23||done||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||N/A||N/A
|-
|rowspan=23|More industry input/output cargos
|IndTile property 13||done||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||N/A||N/A
|-
|IndTile property 12 flag 1||done||done||done||done||N/A||N/A
|-
|Industry property 1A flag 18||done||done||done||done||N/A||N/A
|-
|Industry property 25||done||done||done||done||N/A||N/A
|-
|Industry property 26||done||done||done||done||N/A||N/A
|-
|Industry property 27||done||done||done||done ('cargo_types')||N/A||N/A
|-
|Industry property 28||done||done||done||done ('cargo_types ')||N/A||N/A
|-
|Production callback version 2||done||done||done||done||N/A||N/A
|-
|Industry variable 69||done||done||done||done||N/A||N/A
|-
|Industry variable 6A||done||done||done||done||N/A||N/A
|-
|Industry variable 6B||done||done||done||done||N/A||N/A
|-
|Industry variable 6C||done||done||done||done||N/A||N/A
|-
|Industry variable 6D||done||done||done||done||N/A||N/A
|-
|Industry variable 6E||done||done||done||done||N/A||N/A
|-
|Industry variable 6F||done||done||done||done||N/A||N/A
|-
|Deprecate industry variable 40..42||N/A||done||done||done||N/A||N/A
|-
|Deprecate industry variable 88..89||N/A||N/A||N/A||N/A||N/A||N/A
|-
|Deprecate industry variable 8A..8D||N/A||done||done||done||N/A||N/A
|-
|Deprecate industry variable 90..92||N/A||N/A||N/A||N/A||N/A||N/A
|-
|Deprecate industry variable 94..97||N/A||done||done||done||N/A||N/A
|-
|Deprecate industry variable 98..9B||N/A||done||done||done||N/A||N/A
|-
|Deprecate industry variable 9E..A1||N/A||done||done||done||N/A||N/A
|-
|Deprecate industry variable A2..A5||N/A||done||done||done||N/A||N/A
|-
|Group liveries||Action 5 type 15 sprites 175..178||done||done||done||done||done||N/A
|}

==Vehicle variables==

Below an overview of all vehicle-specific variables. Note that in the purchase list, the vehicle is not built yet and as such many variables are not available. All general variables are available, refer to the table for info on vehicle-specific variables. Trying to access a non-available variable invokes undefined behaviour. Please note that while all variables are available for all vehicles types, some of them only make sense for one or more vehicle types. For example checking current_railtype for a non-rail vehicle doesn't make sense at all, similarly checking current_roadtype for a tram won't return a useful result.

===Variables without parameter===

{| class="t"
! name
! value range
! available in<br />purchase list?
! comment
|-
| position_in_consist
| 0 ... 255
| No
| The position of the current vehicle-part from the start of the vehicle. The engine will get value 0, the first wagon (or second engine) gets value 1, etc.
|-
| position_in_consist_from_end
| 0 ... 255
| No
| Same as position_in_consist but counted from the end. The last wagon will get value 0.
|-
| num_vehs_in_consist
| 1 ... 256
| No
| The total number of vehicles-parts in this vehicle. For aircraft this will include the shadow and the rotor.
|-
| position_in_vehid_chain
| 0 ... 255
| No
| See position_in_consist, but not of the complete vehicle but only all consecutive parts with the same id.
|-
| position_in_vehid_chain_from_end
| 0 ... 255
| No
| See position_in_consist_from_end, but not of the complete vehicle but only all consecutive parts with the same id.
|-
| num_vehs_in_vehid_chain
| 1 ... 256
| No
| See num_vehs_in_consist, but not of the complete vehicle but only all consecutive parts with the same id.
|-
| position_in_articulated_veh
| 0 ... 255
| No
| {{en/Nml|0.3}} {{en/Ottdp|1.4|no|ottdrev=r26157}} The position of the current articulated vehicle from the start of the vehicle. The first will get value 0, the second one gets value 1, etc.
|-
| position_in_articulated_veh_from_end
| 0 ... 255
| No
| {{en/Nml|0.3}} {{en/Ottdp|1.4|no|ottdrev=r26157}} The position of the current articulated vehicle from the end of the vehicle. The last will get value 0, the second last one gets value 1, etc.
|-
| cargo_classes_in_consist
| Bitmask of CC_XXX
| No
|
[[en/NML/Cargos#cargo-classes|cargo classes]]
|-
| most_common_cargo_type
|
[[en/NML/Cargos#cargo-properties|Cargo label]]
| No
| The most common cargo type in the consist.  Prior to nml r2320 this was known as most_common_refit, and didn't work, and was also incorrectly documented :)
|-
| most_common_cargo_subtype
| 0 ... 255
| No
| The most common cargo subtype for most_common_cargo_type
|-
| bitmask_consist_info
| Bitmask 8 bit
| No
|
Binary OR of the values of [[#bitmask-vehicle-info|bitmask_vehicle_info]] of all vehicles (engines, wagons) in the consist. Only available for rail vehicles.
|-
| company_num
| 0 ... 14
| Yes
| company number of the vehicle owner. TTDPatch only supports up to 8 companies (0 ... 7)
|-
| company_type
| PLAYERTYPE_XX
| Yes
| 
;PLAYERTYPE_HUMAN
:human player
;PLAYERTYPE_AI
:AI player
;PLAYERTYPE_HUMAN_IN_AI
:human managing AI company
;PLAYERTYPE_AI_IN_HUMAN
:AI managing human company

OpenTTD only uses PLAYERTYPE_HUMAN and PLAYERTYPE_AI. If you cheat yourself to be part of an AI company OpenTTD will still report PLAYERTYPE_AI for the company with yourself and the AI and it'll report PLAYERTYPE_HUMAN for the now uncontrolled company.
|-
| company_colour1
| COLOUR_XXX
| Yes
|
Refer to the table [[en/NML/List of default colour translation palettes#company-colour-helper-functions|here]] for possible values.
|-
| company_colour2
| COLOUR_XXX
| Yes
|
Same as company_colour1, if no 2nd company colour is chosen. Refer to the table [[en/NML/List of default colour translation palettes#company-colour-helper-functions|here]] for possible values.
|-
| aircraft_height
| 0 ... 255
| No
| Height difference between the aircraft and its shadow. 8 Units are equivalent to one height level on the map.
|-
| airport_type
| AIRPORTTYPE_XX
| No
| 
;AIRPORTTYPE_SMALL
;AIRPORTTYPE_LARGE
;AIRPORTTYPE_HELIPORT
;AIRPORTTYPE_OILRIG
|-
| curv_info_prev_cur
| -2 ... 2
| No
| Difference in direction between the previous (towards engine) vehicle and this vehicle. Curvature to the right is positive. 1 unit is 45 degrees.
|-
| curv_info_cur_next
| -2 ... 2
| No
| Difference in direction between this vehicle and the next (towards rear end) vehicle. Curvature to the right is positive. 1 unit is 45 degrees.
|-
| curv_info_prev_next
| -4 ... 4
| No
| Difference in direction between the previous (towards engine) and next (towards rear end) vehicle. Curvature to the right is positive. 1 unit is 45 degrees. Equal to <code style="color:darkgreen">curve_invo_prev_cur + curv_info_cur_next</code>.
|-
| curv_info
| vehicle_curv_info(''prev_cur'', ''cur_next'')''''
| No
|
Returns a magic number that represents the curvature state of the prev-cur-next vehicle triplet. Do not try to make sense of this magic number, use the [[en/NML/Builtin functions|builtin function]] <code style="color:darkgreen">vehicle_curv_info()</code> instead to make comparisons. <code style="color:darkgreen">curv_info == vehicle_curv_info(a, b)</code> is equivalent to <code style="color:darkgreen">(curv_info_prev_cur == a) &amp;&amp; (curv_info_cur_next == b)</code>, however the former can easily be used in a switch-block.
|-
| motion_counter
| 0 ... 0xFFFFFF
| Yes, always 0
| Is increased every time the vehicle moves a single step on the map. Useful for driving animations.
For that, make the animation use a number of frames, which is a power of two, i.e. 2, 4, 8, 16, 32, ... frames, and then use the lower n bits of motion_counter.
|-
| cargo_type_in_veh
| entry in cargo translation table
| Yes, for the default cargo
| 0xFF if not present in the table
|-
| cargo_unit_weight
| weight per unit in 1/16t
| Yes, for the default cargo
|
|-
| cargo_classes
| Bitmask of [[en/NML/Cargos#cargo-properties|cargo class]]
| Yes, for the default cargo
| class of the currently transported cargo
|-
| vehicle_is_available
| [0 <nowiki>|</nowiki> 1]
| Yes
| Value is 1 if the vehicle is available on the open market
|-
| vehicle_is_testing
| [0 <nowiki>|</nowiki> 1]
| Yes
| Value is 1 if the vehicle is currently being tested
|-
| vehicle_is_offered
| [0 <nowiki>|</nowiki> 1]
| Yes
| Value is 1 if the vehicle is currently being offered for exclusive preview
|-
| build_year
| 0 ... 5000000
| Yes
| 0-based year when the vehicle was built, current year if the vehicle is not built yet
|-
| direction
| DIRECTION_XX
| No
|
See [[en/NML/List of direction constants|here]] for an overview of possible values and their meaning.
|-
| cargo_capacity
| 0 ... 65535
| No
| Cargo capacity (number of units) of the vehicle
|-
| cargo_count
| 0 ... 65535
| No
| Number of cargo units of cargo in the vehicle
|-
| cargo_subtype
| 0 ... 255
| Yes, always 0
| Cargo subtype, used to provide more than one refit option for the same cargo type. See also the <code style="color:darkgreen">cargo_subtype_text</code> callback.
|-
| vehicle_is_powered
| [0 <nowiki>|</nowiki> 1]
| No
| Vehicle provides power and is on the correct track type
|-
| vehicle_is_not_powered
| [0 <nowiki>|</nowiki> 1]
| No
| Vehicle is either on a wrong track type or it doesn't provide power at all
|-
| vehicle_is_potentially_powered
| [0 <nowiki>|</nowiki> 1]
| No
| Vehicle provides power, if it is on a suitable track type
|-
| vehicle_is_flipped
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the sprite is reversed via flip-vehicle-in-depot (trains only)
|-
| vehicle_is_reversed
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle has reversed an odd number of times
|-
| built_during_preview
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle was built during the exclusive preview stage
|-
| current_railtype
| No
| Entry from railtype translation table or 0xFF
| Don't use this variable unless you've defined a railtype translation table. If the train is running on a railtype that is not listed in your railtype translation table this variable will contain 0xFF. Available since OpenTTD r20164.
|-
| current_roadtype
| No
| Entry from current_roadtype translation table or 0xFF
| {{en/Nml|0.5}} {{en/Ottd|1.10}} Don't use this variable unless you've defined a roadtype translation table. If the road vehicle is running on a roadtype that is not listed in your roadtype translation table this variable will contain 0xFF. Available since OpenTTD 1.10.
| Checking this for a tram is not supported and will not return a useful result.
|-
| current_tramtype
| No
| Entry from tramtype translation table or 0xFF
| {{en/Nml|0.5}} {{en/Ottd|1.== OpenTTD 1.10 ==

{|
|-
!Feature!!NFO!!OpenTTD implementation!!NFO spec!!NML implementation!!NML spec!!OpenGFX implementation!!Eints implementation
|-
|rowspan=4|More industry input/output cargos (II)
|Industry variable 70||done||done||done||done||N/A||N/A
|-
|Industry variable 71||done||done||done||done||N/A||N/A
|-
|Deprecate industry variable 8E..8F||N/A||done||N/A||N/A
|-
|Deprecate industry variable 9C..9D||N/A||<span style="display:block; background:cyan; padding-left: 5px;">var included, no details - needs marked deprecated or just removed?</span>||<span style="display:block; background:cyan; padding-left:5px;">No evidence of any NML support - N/A?</span>||<span style="display:block; background:cyan; padding-left:5px;">N/A?</span>||N/A||N/A
|-
|rowspan=2|Railtype non-combined junction sprites
|Railtype property 10 flag 3||done||done||done||done||N/A||N/A
|-
|Railtype action 3 type 0C||done||done||done||done||N/A||N/A
|-
|rowspan=2|Railtype 90 degree turns
|Railtype property 10 flag 4||done||done||done||done||N/A||N/A
|-
|Railtype property 10 flag 5||done||done||done||done||N/A||N/A
|-
|rowspan=32|NRT
|RoadVeh property 05||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:cyan; padding-left:5px;">Done but confusing to authors - both road_type and tram_type resolve to prop 0x05, track_type would have been better?</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||N/A||N/A
|-
|RoadVeh property 1C flag 0 new meaning||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||N/A||N/A
|-
|Global property 16||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:cyan; padding-left:5px;">Appears done</span> [https://github.com/OpenTTD/nml/blob/e8c07ae34f4c4b53deab30361ef51097663dacab/nml/ast/tracktypetable.py#L78 NML src]||<span style="display:block; background:cyan; padding-left:5px;">Done - sparse but enough?</span> [https://newgrf-specs.tt-wiki.net/wiki/NML:Railtypetable NML docs]||N/A||N/A
|-
|Global property 17||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:cyan; padding-left:5px;">Appears done</span> [https://github.com/OpenTTD/nml/blob/e8c07ae34f4c4b53deab30361ef51097663dacab/nml/ast/tracktypetable.py#L89 NML src]||<span style="display:block; background:cyan; padding-left:5px;">Done - sparse but enough?</span> [https://newgrf-specs.tt-wiki.net/wiki/NML:Railtypetable NML docs]||N/A||N/A
|-
|Road/tramtype property 08||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 09||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 0A||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 0B||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 0C||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 0D||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 0F||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 10 flags 0..4||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 13||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 14||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 16||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 17||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 18||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 19||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 1A||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 1B||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 1C||done||done||done||done||N/A||N/A
|-
|Road/tramtype property 1D||done||done||done||done||N/A||N/A
|-
|Vehicle variable 4A for RV||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:cyan; padding-left:5px;">Done but confusing to authors - both current_roadtype and current_tramtype resolve to 0x4A, result depends on vehicle type</span>||done||N/A||N/A
|-
|Road/tramtype variable 40||done||done||done||done||N/A||N/A
|-
|Road/tramtype variable 41||done||done||done||done||N/A||N/A
|-
|Road/tramtype variable 42||done||done||done||done||N/A||N/A
|-
|Road/tramtype variable 43||done||done||done||done||N/A||N/A
|-
|Road/tramtype variable 44||done||done||done||done||N/A||N/A
|-
|Road/tramtype action 3 type 00..02, 04..06, 08, 0A||done||done||done||<span style="display:block; background:cyan; padding-left:5px;">Done. Do docs also need to explain why tramtypes doesn't include 0x0A?</span>||N/A||N/A
|-
|Action 5 type 0B new version with 119 sprites||<span style="display:block; background:cyan; padding-left:5px;">Are these sprites even used? Or are all code paths to them dead?</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||N/A
|-
|Action 5 type 15 sprites 179..183||done||done||done||done||<span style="display:block; background:red; color:white; padding-left: 5px;">drawn, but uncommitted</span>||N/A
|-
|Action 7/9 condition 0F..12||done||done||done||<span style="display:block; background:yellow; padding-left:5px;">?</span>||N/A||N/A
|-
|Push/pop text colours||Control codes 9A 1F, 9A 20||done||done||done||done||N/A||<span style="display:block; background:yellow; padding-left:5px;">?</span>
|-
|GRFID of nearby station tile||Station variable 6A||done ({{en/GHPR|7956}})||done||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||<span style="display:block; background:red; color:white; padding-left: 5px;">missing</span>||N/A||N/A
|}


[[Category:en/Development]]
}} Don't use this variable unless you've defined a tramtype translation table. If the road vehicle is running on a tramtype that is not listed in your tramtype translation table this variable will contain 0xFF. Available since OpenTTD 1.10.
| Checking this for a road vehicle that is not a tram is not supported and will not return a useful result.
|-
| waiting_triggers
|
| No
|
Random triggers waiting to be matched. (see [[en/NML/Random switch|Random switch]])
|-
| random_bits
| 0 ... 255
| No
|
Random data that can be used to randomize certain descisions. (see [[en/NML/Random switch|Random switch]])
|-
| grfid
| 0 ... 0xFFFFFFFF
| No
|
GRFID that defined the [[en/NML/Graphics|graphics]]-block for this vehicle. To compare this with other grfids, use the [[en/NML/Builtin functions|builtin function]] <code style="color:darkgreen">str2number()</code> to convert the other GRFID to a number as well.
|-
| vehicle_type_id
| 0 ... 65535 or a name defined in item block
| No
| GRF-local ID of the vehicle, equal to the item ID. Note that vehicles from other NewGRFs may have the same ID, so you'll generally have to check the <code style="color:darkgreen">grfid</code> as well.
|-
| vehicle_is_hidden
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle is hidden in a depot or tunnel.
|-
| vehicle_is_stopped
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle is stopped, or if it is braking for a stop (trains only).
|-
| vehicle_is_crashed
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle has crashed.
|-
| vehicle_is_broken
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle is broken down.
|-
| date_of_last_service
| date(year, month, day)
| No
|
|-
| breakdowns_since_last_service
| 0 ... 255
| No
| Number of breakdowns since the last service
|-
| reliability
| 0 ... 100
| No
| Reliability (percentage)
|-
| age_in_days
| 0 ... 65535
| No
| Vehicle age in days.
|-
| max_age_in_days
| 0 ... 65535
| No
| Maximum vehicle age in days.
|-
| current_speed
| (speed units)
| No
| The current speed of the vehicle in m/s
|-
| max_speed
| (speed units)
| No
| The maximum speed of the vehicle in m/s
|-
| current_max_speed
| (speed units)
| No
| {{en/Nml|0.3}} {{en/Ottdp|1.3|no|ottdrev=r24246}} Current maximum speed of the vehicle in m/s. This includes e.g. track or timetable limits. Only valid for front vehicle.
|-
| vehicle_is_in_depot
| [0 <nowiki>|</nowiki> 1]
| No
| Value is 1 if the vehicle is inside a depot
|-
| vehicle_is_unloading
| [0 <nowiki>|</nowiki> 1]
| No
| {{en/Ottdp|1.5|2.5|ottdrev=r26430}} Value is 1 if the vehicle is unloading at a station and has not yet started loading new cargo.
|}

===Variables that require an argument===

{| class="t"
! name
! Argument
! value range
! available in<br />purchase list?
! comment
|-
| count_veh_id
| The vehicle ID to look for.
| 0..255
| No
| The number of vehicles in the current consist that have the given ID.
|-
| other_veh_curv_info
| Offset in the chain from the current vehicle.<ref name="offset">Argument range is -128..127. Positive values are interpreted as towards the end, negative values as towards the front. If the offset is outside the vehicle chain, the result value will be 0.</ref>
| -4..4
| No
| Difference in direction between the other vehicle and this vehicle. Curvature to the right is positive. 1 unit is 45 degrees.
|-
| other_veh_is_hidden
| Offset in the chain from the current vehicle.<ref name="offset"/>
| [0 <nowiki>|</nowiki> 1]
| No
| 1 the other vehicle is hidden in a depot or tunnel, 0 otherwise
|-
| other_veh_x_offset
| Offset in the chain from the current vehicle.<ref name="offset"/>
| -128..127
| No
| Signed difference in X-position (top-right to bottom-left) between the other vehicle and this vehicle.
|-
| other_veh_y_offset
| Offset in the chain from the current vehicle.<ref name="offset"/>
| -128..127
| No
| Signed difference in Y-position (top-left to bottom-right) between the other vehicle and this vehicle.
|-
| other_veh_z_offset
| Offset in the chain from the current vehicle.<ref name="offset"/>
| -128..127
| No
| Signed difference in Z-position (upwards) between the other vehicle and this vehicle.
|}
<references/>