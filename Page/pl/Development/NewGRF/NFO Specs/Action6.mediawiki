{{pl/Development/NewGRF/inne strony|en=newgrf-specs.tt-wiki.net/wiki/Action6|pl=pl/Development/NewGRF/NFO Specs/Action6}}
<!--[[Category:Artykuły w języku polskim/Pl]]-->
<!--{{-}}<br>{{ambox | text = w trakcie edycji.}}-->

==Wprowadzenie ==

Działanie 6 pozwala modyfikować zawartość następującego 'sprite'. Wykorzystuje wartości parametrów grf i zapisuje je w danych następnego 'sprite'.

Ta akcja jest przetwarzana tylko raz podczas inicjowania pliku .grf i jest ignorowana podczas kolejnych aktywacji za każdym razem, gdy gra jest uruchamiana lub ładowana. &nbsp;Dlatego, aby warunkowo pominąć tę akcję, musisz użyć akcji 9, a nie akcji 7.

Od wersji TTDPatch 2.0.1 alfa 51 nie jest to już prawdą, działanie 6 zostanie zastosowane zarówno podczas inicjalizacji, jak i aktywacji. Możesz więc użyć akcji 7 lub 9, aby ją pominąć, w zależności od tego, co jest odpowiednie.

== Format ==

Dane wyglądają następująco:

 <sprite-number> * <Length> 06 (<param-num> <param-size> <offset>){n} FF

{| |-
!'''Element'''!![[en/GRFActionsDetailed|'''Size''']]!!'''Description'''
|-
|<sprite-number>||dec||A sequential sprite number
|-
|<length>||dec||The total number of bytes used in this action
|-
|06||B||Defines action 06
|-
|<param-num>||B||Which grf parameter to apply
|-
|<param-size>||B||How many bytes to overwrite
|-
|<offset>||B*||Which byte to overwrite
|-
|<FF>||B||Marks the end of the list
|}

Triplet <param-num> <param-size> <offset> można powtarzać tak często, jak to pożądane.

== Description ==

=== Sprite-number ===

To tylko numer, na którym jesteś.

=== Length ===

Policz liczbę bajtów w tej akcji.

=== param-num ===

Jest to numer parametru z parametrów newgrf(w).cfg, który ma zastosowanie do następujących danych duszka. Może to oczywiście wynikać również z obliczeń ActionD. Pierwszy parametr ma numer 00.

Modyfikacja nie jest przeprowadzana, jeśli parametr nie został jeszcze zdefiniowany.

=== param-size ===

Ile bajtów parametru użyć. Jeśli jest to więcej niż 4 (rozmiar parametru), używane są bajty następującego parametru. W takim przypadku należy zdefiniować wszystkie wymagane parametry, w przeciwnym razie nie zostaną wykonane żadne modyfikacje.

Jeśli ta wartość ma ustawiony bit 7, parametr jest ''added'' do wartości docelowej, zamiast po prostu zapisywany. Jest to przydatne szczególnie przy alokacji duszków za pomocą GRF Resource Management, ponieważ zwykle alokuje się więcej niż jedną duszkę, ale parametr może przechowywać tylko jedną liczbę, pierwsza przydzielona duszka. &nbsp;Tak więc, aby poprawnie zastosować kilka liczb ikonek (tak, że działa na kilka aktywacji, nie tylko na pierwszą), użyj algorytmu takiego jak poniżej:
* Suppose you have a sprite number <nowiki><s></nowiki> to which you want to add <nowiki><i></nowiki> (where <nowiki><i></nowiki> is returned by the GRF Resource Management)
* To make this work several times (whenever the grf is activated), you cannot simply add <nowiki><i></nowiki> to <nowiki><s></nowiki> directly
* Instead, use [[en/ActionD]] to define a new, otherwise unused parameter <j>, and store in it the value of <nowiki><i></nowiki> before it is set by Action D, i.e. <j> holds the previous value of <nowiki><i></nowiki>.
* Next, after setting <nowiki><i></nowiki> with the GRF Resource Management, calculate <j> = <nowiki><i></nowiki> - <j> (i.e. subtract the previous value of i from the new value of i and store in j).
* Use Action 6 to add the value of <j> to <nowiki><s></nowiki>, instead of adding the value of <nowiki><i></nowiki> directly.
* This way, the new value <nowiki><s></nowiki> is the current value of <nowiki><s></nowiki> plus the new <nowiki><i></nowiki> minus the old <nowiki><i></nowiki>, which is the initial value of <nowiki><s></nowiki> plus the new <nowiki><i></nowiki>, just what we wanted.
* Skip the action D's as well as both action 6 and the action it modifies during the [[en/GrfLoadingStages|"test" stage]] by skipping these actions if action 7 var 84 has bit 10 set.
* Make sure that when using action 7/9, that either ''both'' or ''none'' of the above two operations are skipped. if only one but not the other is skipped, the values will go out of synch.

Przykład poniżej.

=== offset ===

Liczba bajtów w poniższym ikonce do zmodyfikowania. Liczenie zaczyna się od 0 w bajcie akcji i może wzrosnąć do długości duszka. Nie ma możliwości dodania danych na końcu duszka.

Since {{Page:pl/Extrazi/ottdp| |2.5|ttdprev=alpha 51}}, this is an extended byte (see [[en/GRFActionsDetailed]]).

== Przykład ==

To jest przykład zastosowania liczb sprite zwróconych przez GRF Resource Management do akcji 0:

<pre>// First, set param 1 (<j>) to the old value of param 0 (<i>)

&nbsp; -1 * 5 &nbsp; &nbsp; &nbsp; &nbsp;0D 01 00 00 00

// Then, use the GRF Resource Management to reserve 3 sprites

&nbsp; -1 * 9 &nbsp; &nbsp; &nbsp; &nbsp;0D 00 00 00 FE FF 08 03 00

// Now calculate <j> = <i> - <j>

&nbsp; -1 * 5 &nbsp; &nbsp; &nbsp; &nbsp;0D 01 02 00 01

// So <j> = new <i> - old <i>

// Use Action 6 to add <j> to the sprite numbers in the sample sprite layout

&nbsp; -1 * 11 &nbsp; &nbsp; &nbsp; 06 01 84 07 01 84 11 01 84 1B FF

&nbsp; -1 * 32 &nbsp; &nbsp; &nbsp; 00 04 01 01 00 09

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;01

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00 00 00 00 &nbsp; &nbsp; // first allocated sprite

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00 00 00 &nbsp;10 05 02 &nbsp;01 00 00 00 // second allocated sprite

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00 0B 00 &nbsp;10 05 02 &nbsp;02 00 00 00 // third

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;80

</pre>