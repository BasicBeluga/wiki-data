{{pl/Development/NewGRF/inne strony|en=newgrf-specs.tt-wiki.net/wiki/VariationalAction2/Houses|pl=pl/Development/NewGRF/NFO Specs/VariationalAction2/Houses}}
<!--{{-}}<br>--><!--{{ambox | text = w trakcie edycji.}}--><!-- -->
==Wprowadzenie==

== Variables ==

{| |-
!Variable!![[pl/Development/NewGRF/NFO Specs/GRFActionsDetailed|'''Size''']]!!Version*!!Description
|-
|40||B||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||Construction stage and pseudo-random values
|-
|41||B||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||Age of the building in years (or, strictly speaking, the difference between the current year and the year the building was built). Returns 255 for buildings older than 255 years.
|-
|42||B||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 43}}||Town zone where the building is situated.
|-
|43||B||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||Terrain type: 0 normal, 1 desert, 2 rainforest, 4 on or above snowline
|-
|44||D||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 43}}||Building counts
|-
|45||B||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 38}}||Town expansion bits
|-
|46||B||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 67}}||Current animation frame
|-
|47||D||{{pl/Development/NewGRF/ottdp|0.7|2.6|ottdrev=r14294|ttdprev=r2020}}||XY Coordinate of the building
|-
|60||D||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 56}}||Other building counts
|-
|61||D||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 56}}||Other building counts
|-
|62||D||{{pl/Development/NewGRF/ottdp|0.6|2.5|ttdprev=alpha 72}}||Land info for nearby tiles
|-
|63||B||{{pl/Development/NewGRF/ottdp|0.7|2.6|ttdprev=r1665}}||Current animation frame of nearby house tiles
|-
|64||B||{{pl/Development/NewGRF/ottdp|1.2|2.6|ottdrev=r23070|ttdprev=r1672}}||Cargo acceptance history of nearby stations
|-
|65||B||{{pl/Development/NewGRF/ottdp|0.7|2.6|ottdrev=r13603|ttdprev=r2242}}||Distance of nearest house matching a given criterion
|-
|66||D||{{pl/Development/NewGRF/ottdp|1.0|2.6|ttdprev=r2246}}||Class and ID of nearby house tile
|-
|67||D||{{pl/Development/NewGRF/ottdp|1.0|2.6|ttdprev=r2246}}||GRFID of nearby house tile
|-
|80+x||||||None defined, and none ever will because town buildings don't have an internal structure. Trying to access these variables crashes TTD.
|}

<nowiki>*</nowiki> Określona wersja jest najwcześniej znana z obsługi zmiennej w jej bieżącej formie. Niektóre zmienne mogły być dostępne wcześniej.

== Description ==

=== Construction stage and pseudo-random values (40) ===

{| |-
!Bits!!Meaning
|-
|0..1||Construction state: 0..2: various states of construction, 3: construction finished
|-
|2..3||A pseudo-random value. It isn't actually random, but is derived from the position of the building. Old buildings use this value to randomize their colors. TTDPatch has a better way to randomize things, but you can still use that value to mimic unpatched TTD behaviour. Note that adjacent tiles aren't guaranteed to have the same pseudo-random bits
|}

=== Town zone (42) ===

Strefa miasta, w której znajduje się budynek. Wartość wynosi od 0 do 4, gdzie 0 jest najbardziej oddaloną strefą miasta. Mniejsze miasta mają mniej stref. Drogi są gładkie w strefie 0 i 1, utwardzone w strefie 2, drzewa w strefie 3 i latarnie w strefie 4

=== Building counts (44) ===

Zwraca dword LLllCCcc, gdzie cc oznacza, ile budynków bieżącego typu można znaleźć w bieżącym mieście, podczas gdy CC jest takie samo dla całej mapy. II i LL są podobne do CC i CC, ale zawierają liczbę płytek o tej samej klasie co bieżąca. Dla płytek, które nie mają żadnej klasy, ll i LL są zawsze równe zero. Zastąpione stare typy są uważane za nowy typ, którym zostały zastąpione. Podczas [[pl/Development/NewGRF/NFO Specs/Callback/Main Page#house-construction-check-17|callback 17]] bieżący budynek nie jest jeszcze na mapie i dlatego nie jest liczony. W innych przypadkach liczba budynków wynosi co najmniej jeden, ponieważ liczony jest również obecny budynek.

=== Town expansion bits (45) ===

{| |-
!Bit!!Value!!Meaning
|-
|0||1||Set if TTD is currently creating a random town, clear otherwise. PLEASE NOTE: while TTD is generating a random town, town variables 82 (town population) and B6 (number of buildings) are incorrect. The population counter contains the population of buildings generated _yet_, which means the final value may be larger than you get. The building count variable, on the other hand, is surely higher than the final value will be. If you want to check these variables during [[pl/Development/NewGRF/NFO Specs/Callback/Main Page#house-construction-check-17|callback 17]], you may need to check variable 45 as well and make adjustments if this bit is set.
|}

Inne bity są obecnie zarezerwowane do wykorzystania w przyszłości.

=== Current animation frame (46) ===

Wyświetlana jest bieżąca klatka animacji. Jeśli nie używasz wywołań animacji, mieści się ona między zerem a wartością ustawioną we właściwości 1A. Oddzwanianie animacji może ustawić dowolną wartość z zakresu od 0 do 127.

Włączenie animacji na kafelku domu poprzez ustawienie właściwości 9, 1A i prawdopodobnie 1B zapewnia, że ​​zmienna 46 rzeczywiście zmienia się z czasem, a budynek jest przerysowywany za każdym razem, gdy zmienia się zmienna 46. Oznacza to, że możesz użyć VarAction2, aby wybrać bieżącą klatkę zgodnie ze zmienną 46. Pamiętaj, że ten rodzaj animacji wymaga więcej czasu procesora i więcej duszków, więc jeśli to możliwe, powinieneś preferować animację paletową.

=== XY Coordinate of the building (47) ===

Współrzędna płytki, w której znajduje się ta część budynku. &nbsp;Jeśli budynek nie został jeszcze zbudowany, np. Podczas [[pl/Development/NewGRF/NFO Specs/Callback/Main Page#house-construction-check-17|callback 17]] , zwróconą wartością będzie proponowana lokalizacja. &nbsp;Format var to RRRRXXXX.

=== Other building counts (60, 61) ===

Dla zmiennej 60 parametrem jest stary numer typu domu. Dla zmiennej 61 jest to nowy numer typu domu zdefiniowany w bieżącym pliku GRF.

Zmienne te działają jak zmienna 44, ale liczą dany typ domu zamiast bieżącego.

Należy pamiętać, że w przeciwieństwie do losowej grafiki, zmiany deterministycznej grafiki budynku nie przerysowują automatycznie budynku (z wyjątkiem sytuacji, gdy zmienia się stan konstrukcji lub zmienna 46), co powoduje tymczasowe usterki grafiki, gdy widoczny budynek zmienia swoją grafikę. Te usterki można naprawić, przewijając budynek poza zasięgiem wzroku, a następnie ponownie.

=== Land info for nearby tiles (62) ===

Ta zmienna działa dokładnie tak, jak [[pl/Development/NewGRF/NFO Specs/VariationalAction2/Industry Tiles#land-info-of-nearby-tiles-60|var. 60 for industry tiles]] , z wyjątkiem tego, że bit 0 części '''bb''' jest niezdefiniowany.

=== Current animation frame of nearby house tiles (63) ===

Parametr tej zmiennej jest przesunięciem względem położenia bieżącego kafelka. Niby-nibble zawiera podpisane przesunięcie X (to znaczy 0h=0, 1h=+1 ... 7h=+7; 8h=-8, 9h=-7 ... Fh=-1 ), high-nibble zawiera Przesunięcie Y Chociaż możesz zapytać o obszar 16x16 za pomocą tych parametrów, obecnie nie ma potrzeby używania przesunięć innych niż -1, 0 i +1; jeśli zapytasz o kafelek, który nie należy do tego samego budynku, co bieżący, wynik jest bez znaczenia. Może to być nawet śmieci, jeśli pytana płytka wcale nie jest płytką domową.

=== Cargo acceptance history of nearby stations (64) ===

Parametrem tej zmiennej jest identyfikator ładunku. {{pl/Development/NewGRF/grfFrom|7}} Jeśli twój GRF ma wersję 7 lub nowszą i ma tabelę translacji ładunku, jest to indeks do tej tabeli; w przeciwnym razie jest to numer przedziału ładunkowego. Ponadto rejestr GRF 100h powinien zawierać przesunięcie względem bieżącego kafelka (użyj 0 dla bieżącego kafelka). Najniższy bajt zawiera przesunięcie X ze znakiem, a następny wyższy bajt zawiera przesunięcie Y ze znakiem.

Zwrócona wartość wygląda następująco:

{| |-
!Bit number!!Meaning
|-
|0||This cargo was accepted in a nearby station some time in the past
|-
|1||This cargo was accepted in a nearby station last month
|-
|2||This cargo was accepted in a nearby station this month
|-
|3||This cargo was accepted in a nearby station since the last periodic processing (which happens every 250 ticks)
|-
|4||This cargo is one of the types that triggered [[pl/Development/NewGRF/NFO Specs/Callback/Main Page#watched-cargo-accepted-148|callback 148]] (only during callback 148)
|-
|other bits||undefined; reserved for future use
|}

W pobliżu znajduje się stacja, jeśli wybrana płytka znajduje się w obszarze akceptacji. Dlatego możesz podać przesunięcie <small>''(offset)''</small>- inne płytki w budynku z wieloma płytkami mogą mieć różne stacje "w pobliżu" <small>''(nearby)''</small> .

{{pl/Development/NewGRF/ttdp|}} Informacje wymagane dla tej zmiennej są przechowywane w strukturze station2 i dlatego działają tylko wtedy, gdy obecna jest struktura station2. Struktura station2 jest obecna, jeśli spełniony jest jeden z poniższych warunków:
* Generalfixes jest włączony, a miscmods.noextendstationrange jest wyłączony
* Włączono dowolne ładowanie, ładowanie nowych lub nieregularne stacje

Jeśli struktura station2 nie jest obecna, zwracana wartość jest zawsze równa zero.

=== Distance of nearest house matching a given criterion (65) ===

Spowoduje to wykonanie cyklicznego wyszukiwania wokół bieżącego kafelka, próbując znaleźć inny kafelek domu, który będzie pasował do tego samego typu, klasy lub GRFID. (Uwaga: inne kafelki domu pochodzącego nie będą pasować.) &nbsp;Wynikiem wyszukiwania będzie [http://en.wikipedia.org/wiki/Taxicab_geometry Manhattan distance] między obiema płytkami lub 0, jeśli nie znaleziono płytki domu spełniającej podane kryteria.

Parametr tej zmiennej składa się z dwóch części:

Bity 0..5 wskazują promień wyszukiwania, które ma zostać wykonane (podane w metrach Manhattanu). Maksymalny promień wyszukiwania to 63, a minimalny to 1. Promień 0 jest uważany za zarezerwowany - nie używaj.

Bity 6..7 wskazują rodzaj wyszukiwania, które należy przeprowadzić:

0: Wyszukaj według typu domu zdefiniowanego w pliku grf

1: Wyszukaj według klasy budynku

2: Wyszukaj według GRFID

Podobnie jak inne zmienne wyszukiwania, pamiętaj, że jest to procesor intensywny

=== Class and ID of nearby house tile (66) ===

Parametr tej zmiennej jest przesunięciem względem położenia bieżącego kafelka. Niby-nibble zawiera podpisane przesunięcie X (to znaczy 0h=0, 1h=+1 ... 7h=+7; 8h=-8, 9h=-7 ... Fh=-1 ), high-nibble zawiera Przesunięcie Y Zwrócona wartość ma następującą strukturę:

{| |-
!High word!!Information about house class
|-
|||'''FFFFh''' if the selected tile isn't a house tile
|-
|||'''0000h''' if the selected house doesn't have a class specified (including old houses, which cannot have a class)
|-
|||'''01XXh''' if the selected house has been defined in the current GRF with class XX
|-
|||'''02XXh''' if the selected house has been defined in a different GRF with class XX
|-
!Low word!!Information about house ID
|-
|||'''FFFFh''' if the selected tile isn't a house tile
|-
|||'''00XXh''' if the selected house is old house type XX
|-
|||'''01XXh''' if the selected house has been defined in the current GRF with ID XX
|-
|||'''02XXh''' if the selected house has been defined in a different GRF with ID XX
|}

W przypadku, gdy wybrany dom pochodzi z innego GRF, musisz użyć zmiennej 67 (patrz poniżej), aby znaleźć odpowiedni GRFID i zidentyfikować dokładny typ domu. Należy pamiętać, że zmienna 67 jest tańsza do obliczenia niż ta, więc jeśli szukasz konkretnej kombinacji GRFID/houseID, powinieneś najpierw spróbować dopasować GRFID, a uzyskać zmienną 66 tylko wtedy, gdy GRFID pasuje.

=== GRFID of nearby house tile (67) ===

Parametr tej zmiennej jest przesunięciem względem położenia bieżącego kafelka. Niby-nibble zawiera podpisane przesunięcie X (to znaczy 0h=0, 1h=+1 ... 7h=+7; 8h=-8, 9h=-7 ... Fh=-1 ), high-nibble zawiera Przesunięcie Y Zwrócona wartość jest jedną z następujących czynności:
* '''FFFFFFFFh''' jeśli wybrany kafel nie jest kaflem domu
* '''00000000h''' jeśli wybrany dom jest starym typem domu
* w przeciwnym razie GRFID GRF, który zdefiniował typ wybranego domu

==Przykład==