{{pl/Development/NewGRF/inne strony|en=newgrf-specs.tt-wiki.net/wiki/VariationalAction2/Industries|pl=pl/Development/NewGRF/NFO Specs/VariationalAction2/Industries}}
<!--{{-}}<br>--><!--{{ambox | text = w trakcie edycji.}}--><!-- -->
==Wprowadzenie==

== Variables ==

{| |-
!Variable !![[en/GRFActionsDetailed|Size]] !!Version !! Description
|-
|40..42||||{{en/Ottdp| | }}||Waiting cargo. See also variable 6F.
|-
|43||||{{en/Ottdp| |2.6|ttdprev=r1298}}||Manhattan distance of closest dry/land tile
|-
|44||||{{en/Ottdp| |2.6|ttdprev=r1594}}||Layout number (1-based)
|-
|45||||{{en/Ottdp| |2.6|ttdprev=r1711}}||Player info
|-
|46||||{{en/Ottdp|0.7|2.6|ttdprev=r2047|ottdrev=r13443}}||Date when industry was built in days since year 0
|-
|60||||{{en/Ottdp| |2.5|ttdprev=alpha 73}}||Get industry tile ID at offset
|-
|61||||{{en/Ottdp| |2.5|ttdprev=alpha 73}}||Get random tile bits at offset
|-
|62||||{{en/Ottdp| |2.5|ttdprev=alpha 74}}||Land info of nearby tiles
|-
|63||||{{en/Ottdp| | }}||Animation stage of nearby tiles
|-
|64||||{{en/Ottdp| | }}||Distance of nearest industry with given type
|-
|65||||{{en/Ottdp| | }}||Get [[en/TownZones|town zone]] and Manhattan distance of closest town
|-
|66||||{{en/Ottdp| | }}||Get square of Euclidean distance of closest town
|-
|67||||{{en/Ottdp| | }}||Count of industry, distance of closest instance
|-
|68||||{{en/Ottdp| | }}||Like the above, but with layout filter
|-
|69||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Amount of produced output cargo waiting to be distributed.
|-
|6A||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Amount of cargo produced this month (so far).
|-
|6B||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Amount of cargo transported this month (so far).
|-
|6C||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Amount of cargo produced last month.
|-
|6D||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Amount of cargo transported last month.
|-
|6E||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Date since cargo was delivered last. (in days since year 0)
|-
|6F||||{{en/Ottdp|1.9|no|ottdrev=e66cec8f}}||Amount of waiting cargo to be processed.
|-
|70||||{{en/Ottdp|1.10|no|ottdrev=fdaf67d924}}||Production rate of cargo.
|-
|71||||{{en/Ottdp|1.10|no|ottdrev=fdaf67d924}}||Percentage of cargo transported last month.
|-
|8A||W||{{en/Ottdp| | }}||Amount of produced output cargo waiting to be distributed, for the first output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 69.
|-
|8C||W||{{en/Ottdp| | }}||Amount of produced output cargo waiting to be distributed, for the 2nd output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 69.
|-
|93||B||{{en/Ottdp| | }}||Production level. Normally between 4 and 128, default starting level is 16. A level of 0 means imminent closure.
|-
|94||W||{{en/Ottdp| | }}||Production this month of first output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6A.
|-
|96||W||{{en/Ottdp| | }}||Production this month of 2nd output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6A.
|-
|98||W||{{en/Ottdp| | }}||Amount of cargo transported this month of the first output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6B.
|-
|9A||W||{{en/Ottdp| | }}||Amount of cargo transported this month of the 2nd output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6B.
|-
|9C||B||{{en/Ottdp| | }}||Fraction of cargo transported last month of the first output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 71.
|-
|9D||B||{{en/Ottdp| | }}||Fraction of cargo transported last month of the 2nd output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 71.
|-
|9E||W||{{en/Ottdp| | }}||Production last month of the first output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6C.
|-
|A0||W||{{en/Ottdp| | }}||Production last month of the 2nd output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6C.
|-
|A2||W||{{en/Ottdp| | }}||Amount of cargo transported last month of the first output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6D.
|-
|A4||W||{{en/Ottdp| | }}||Amount of cargo transported last month of the 2nd output cargo. {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}Deprecated, see instead variable 6D.
|-
|A7||B||{{en/Ottdp| |2.5|ttdprev=alpha 74}}||Industry founder information
|-
|A8||B||{{en/Ottdp| | }}||Random (company) colour, chosen during construction
|-
|B0||W||{{en/Ottdp| | }}||Date when industry was built in days since 1920
|-
|B3||B||{{en/Ottdp| | }}||Construction type
|-
|B4||W||{{en/Ottdp| |2.6|ttdprev=r1321}}||Date when cargo was last accepted in days since 1920, or 0 if no cargo was ever accepted. See also variable 6E.
|}

For other 80+x variables confer the [http://marcin.ttdpatch.net/sv1codec/TTD-locations.html#_IndustryArray TTD industry structure].

=== Waiting cargo (40..42) ===

If bit 1 or 2 is set in property 21, these variables contain the amount of incoming cargo waiting to be processed. (40 gives the amount of the first type waiting, 41 gives the same for the second type etc.) These variables are capped at FFFFh (65535).

See also variable 6F.

=== Manhattan distance of closest dry/land tile (43) ===

This variable works the same way as var. 8B does during callback 28: if your industry is built on water, it gives the distance of the closest dry land tile, otherwise it gives the distance of the closest water tile. However, you can't use this variable during callback 28; you must always use 8B.

'''PLEASE NOTE''': This variable is rather expensive to compute because, in the worst case, it has to check all tiles on the map before it gives up looking for a good tile. Try to avoid it in frequent callbacks such as the production callback, animation callbacks (unless the animation is slow, around 1 frame per game day or slower). It is, however, OK to use it during the production change callbacks.

=== Layout number (44) ===
T
his variable returns the number of the current layout. The first layout will return 01, the second 02, etc. In other words, this is one larger than what you get in variable 86 during callback 28.

If the industry was created using an earlier version of TTDPatch, or while newindustries was off, the result will be zero.

=== Player info (45) ===

As [[en/VarAction2Vehicles#player-info-43|vehicle variable 43]], except that the no-player state is indicated by var A7 being 10h.

=== Date when industry was built in days since year 0 (46) ===

Exact same behaviour as var B0, but based on year 0, instead of year 1920

In TTDPatch, industry age is limited to 65535 days (approximately 180 years) -- build date is never more than 65535 days ago.

=== Get industry tile ID at offset (60) ===

The parameter of this variable is an offset from the northernmost tile of the industry: the high nibble contains the Y offset, the low one the X offset; both are unsigned. The high word of the return value is currently reserved, and the low word can be:
* 00xxh if the tile is an industry tile and was defined in the current GRF with ID xx.
* FFxxh if the tile is an industry tile of an old type, and has the ID xx.
* FFFEh if the tile is an industry tile that was defined in another GRF file
* FFFFh if the tile isn't an industry tile, or doesn't belong to the current industry

=== Get random tile bits at offset (61) ===

The parameter of this variable is an offset from the northernmost tile of the industry: the high nibble contains the Y offset, the low one the X offset; both are unsigned. If there's an industry tile on that offset and it belongs to the current industry, the lowest byte of the return value will contain the random bits of that tile. Otherwise, the lowest byte will be zero.

The other bytes are reserved for future use.

=== Land info of nearby tiles (62) ===

The parameter of this variable is an offset from the northernmost tile of the industry: the high nibble contains the Y offset, the low one the X offset; both are unsigned. This variable returns the same values as [[en/VarAction2IndustryTiles#land-info-of-nearby-tiles-60|industry tile variable 60]], in the same format, except that bit 0 in the '''bb''' part is undefined. The offset should be given relatively to the north corner of the industry.

=== Animation stage of nearby tiles (63) ===

The parameter of this variable is an offset from the northernmost tile of the industry: the high nibble contains the Y offset, the low one the X offset; both are unsigned. This variable returns the same values as [[en/VarAction2IndustryTiles#animation-stage-for-nearby-tiles-61|industry tile variable 61]], in the same format. The offset should be given relatively to the north corner of the industry.

=== Distance of nearest industry with given type (64) ===

The format of the parameter is the same as for industry property 16: either the ID of a new type with bit 7 set, or the ID of an old type. The returned value is FFFFFFFFh if there are no industries with the given type (not counting the current one, if it has the given type); otherwise, the returned value is the Manhattan distance of the closest industry with the given type.

=== Get [[en/TownZones|town zone]] and Manhattan distance of closest town (65) ===

The parameter gives an offset from the northernmost tile of the industry: the high nibble means the Y offset, the low nibble means the X offset, both signed. The returned value is rrzzdddd, where rr is reserved for future use, zz is the [[en/TownZones|town zone]] of the selected tile, while dddd is the Manhattan distance of the closest town.

=== Get square of Euclidean distance of closest town (66) ===

The parameter works like for var. 65, but the result is the Euclidean distance of the closest town, squared.

=== Count of industry, distance of closest instance (67, 68) ===

Variable 67 gets two parameters: the GRFID of the GRF where the industry is defined in register 100h (can be written using operator 0E of [[en/VarAction2Advanced|VarAction2]]) and the setID of the industry as the regular parameter. There are two special cases for the GRFID: 00000000h means you're checking for a default TTD industry type, while FFFFFFFFh can be used instead of the GRFID of the current GRF.

The return value has the format rrccdddd, where rr is reserved for future use, cc is the number of instances of the industry type and dddd is the Manhattan distance of the closest instance, of FFFFh if not appliable.

You may note that this variable can be used instead of variable 64. This variable is the preferred way to get this information since it allows you to check industries defined in other GRFs as well. Variable 64 will stay for backward compatibility only.

Variable 68 works like variable 67, except that you can put a layout number in the lowest byte of register 101. (The other bits are reserved for future use, leave them zero for now.) This layout number should be 1-based (the first layout is 01, not 00). Only industries with the given layout are considered for counting and calculating distance. As a special case, if the layout number is 00, all layouts are counted, and so the result is the same as with variable 67.

Since OpenTTD r22434, it is possible to filter by the town of the current industry. If the bit number 8 is set, only industries in the same town than the current one will be considered.

=== Cargo info variables (69..71) ===

These variables allow to query information about accepted and produced cargos.
The variables are independent of the number of cargo types and their order. The 60+x parameter specifies the cargo type as index into the cargo translation table.

(69..6F) {{en/Ottdp|1.9|no|ottdrev=e66cec8f}}

* Variable 69: amount of produced cargo waiting to be transported.
* Variable 6A: amount of cargo produced this month.
* Variable 6B: amount of cargo transported this month.
* Variable 6C: amount of cargo produced last month.
* Variable 6D: amount of cargo transported last month.
* Variable 6E: date cargo was last delivered to the industry.
* Variable 6F: amount of delivered cargo waiting to be processed.

(70..71) {{en/Ottdp|1.10|no|ottdrev=fdaf67d924}}

* Variable 70: primary industry production rate.
* Variable 71: last month transported (FF = 100%).

=== Industry founder information (A7) ===

This byte contains the ID of the company that funded the industry, or 10h if the industry was generated randomly. If the industry was built using an earlier TTDPatch than 2.0.1 &alpha;74 or with newindustries turned off, this field is 10h.

=== Construction type (B3) ===

This byte tells you how the industry got onto the map. The following values are possible:

{| |-
!Value!!Meaning
|-
|0||Unknown - This industry was built with newindustries being off, or in a TTDPatch version prior to TTDPatch 2.0.1 alpha 74
|-
|1||Created during normal gameplay, either by a player or the in-game random industry generator
|-
|2||Created during random map generation
|-
|3||Created in the scenario editor
|}

W przypadku 1 możesz sprawdzić zmienną A7, aby dowiedzieć się, czy przemysł został sfinansowany przez gracza, czy przez losowy generator.