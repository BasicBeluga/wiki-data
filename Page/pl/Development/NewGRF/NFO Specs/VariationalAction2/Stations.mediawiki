{{pl/Development/NewGRF/inne strony|en=newgrf-specs.tt-wiki.net/wiki/VariationalAction2/Stations|pl=pl/Development/NewGRF/NFO Specs/VariationalAction2/Stations}}
<!--{{-}}<br>--><!--{{ambox | text = w trakcie edycji.}}--><!-- -->
==Wprowadzenie==

Stacje kolejowe mają wiele zmiennych z portami lotniczymi. Wspólne zmienne są udokumentowane na [[pl/Development/NewGRF/NFO Specs/VariationalAction2/BaseStation|separate page]]

== Variables ==
{| |-
!Variable!!Version!![[pl/Development/NewGRF/NFO Specs/GRFActionsDetailed|'''Size''']]!!Description
|-
|10||{{pl/Development/NewGRF/ottdp|0.7|2.5}}||D||Dodatkowe informacje dotyczące wyboru 'sprite' - zobacz [[pl/Development/NewGRF/NFO Specs/Action0/Stations#general-flags-13|General station flags]] i [[en/AdvancedSpriteLayout|AdvancedSpriteLayout]]
|-
|40||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||D||Platform info and relative position
|-
|41||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||D||Platform info and relative position for individually built sections
|-
|42||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||D||Terrain and track type
|-
|43 <ref>{{pl/Development/NewGRF/ottdp|1.2|2.5|ottdrev=r22848|ttdprev=2.5 beta 2}} Dostępne również na liście zakupów.</ref>||{{pl/Development/NewGRF/ottdp|1.2|2.5|ottdrev=r22848}}||D||Informacje o graczu, patrz [[pl/Development/NewGRF/NFO Specs/VariationalAction2/Vehicles#player-info-43|vehicle variable 43]]
|-
|44||{{pl/Development/NewGRF/ottdp|0.7|2.5}}||B||Path-based signalling info
|-
|45||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||W||Rail continuation info
|-
|46,47||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||D||Platform info, counted from the middle
|-
|48|| || ||See [[pl/Development/NewGRF/NFO Specs/VariationalAction2/BaseStation|Base Stations]].
|-
|49||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||D||Platform info and relative position of same-direction section
|-
|4A||{{pl/Development/NewGRF/ottdp|0.7|2.5}}||B||Current animation frame
|-
|60-65|| || ||See [[pl/Development/NewGRF/NFO Specs/VariationalAction2/BaseStation|Base Stations]].
|-
|66||{{pl/Development/NewGRF/ottdp|0.6|2.5}}||D||Animation frame of nearby tile
|-
|67||{{pl/Development/NewGRF/ottdp|0.6|2.6}}||D||Land info of nearby tiles
|-
|68||{{pl/Development/NewGRF/ottdp|0.6|2.6}}||D||Station info of nearby tiles
|-
|69|| || ||See [[pl/Development/NewGRF/NFO Specs/VariationalAction2/BaseStation|Base Stations]].
|-
|6A||{{pl/Development/NewGRF/ottdp|1.10|no|ottdrev=5df01bf}}||D||GRFID of nearby tiles
|-
|80||{{pl/Development/NewGRF/ottdp|no|no}} <ref>Works in TTDPatch for sufficiently small stations.</ref>||B||Number and length of train platforms
|}
<references/>

W przypadku innych zmiennych 80+x nadaj [http://marcin.ttdpatch.net/sv1codec/TTD-locations.html#_StationArray TTD station structure] . Zauważ, że musisz odjąć 0x10 od przesunięć tam, w przeciwnym razie maska ​​bitowa obiektu i data budowy nie byłyby dostępne; zamiast tego tracisz dostęp do zmiennych 00..0F, które i tak są bez znaczenia.

'''UWAGA''': Proszę nie używać bezpośrednio zmiennych 8C..EB. Znaczenie tych zmiennych zmienia się, jeśli przełącznik newcargos jest włączony. Zamiast tego użyj zmiennych 60..64 (patrz poniżej). Te zawsze działają poprawnie.

== Description ==
=== Platform info (40, 41, 46, 47, 49) ===

Zmienne 40, 41, 46, 47 i 49 zwracają informacje o bieżącym kafelku, na której platformie on jest i jak daleko wzdłuż platformy. Różnica polega na rozważanym odcinku stacji.

{| |-
!Variables!!Regular station!!Irregular station
|-
|40, 46||Whole station||Counting entire length and all adjacent platforms
|-
|41, 47||Individually built sections||
|-
|49||Whole station||Counting length and platforms that have the same direction
|}

Termin "liczenie" <small>''(counting)''</small> odnosi się tutaj do rozpoczynania od danego kafelka i liczenia płytek we wszystkich czterech kierunkach. Dwa kierunki wyrównane z kierunkiem stacji będą długością stacji, a pozostałe dwa kierunki podadzą liczbę platform. W przypadku zmiennych 40 i 46 liczenie to zatrzymuje się na krawędzi stacji, tj. Pierwszej płytki niestacjonarnej. Dla zmiennej 49 zatrzymuje się na krawędzi lub na kafelku stacji, który jest w złym kierunku. &nbsp;Uzyskane informacje prawdopodobnie nie są naprawdę przydatne w przypadku nieregularnych stacji, z wyjątkiem wykrywania krawędzi. Aby poprawnie wykryć krawędzie, możesz wybrać jedną ze stacji-&gt;przejście niestacjonarne (var. 40, 46) lub dodatkowe przejście w przeciwnym kierunku (var. 49).

Zmienne 41 są w dużej mierze niezależne od nieregularnych stacji, ponieważ odnoszą się tylko do indywidualnie budowanych odcinków. Jednak gdy te poszczególne sekcje są budowane na istniejących płytkach, var. 41 informacji o otaczających kafelkach również się zmienia, ze względu na wewnętrzne ograniczenie sposobu ich przechowywania.

Dla zmiennych 40, 41 i 49 pozycja jest liczona od najbardziej wysuniętej na północ krawędzi stacji i zwracana w postaci xTNLcCpP, gdzie:

{| |-
!Variable!!Meaning
|-
|x||undefined, use bit mask to mask it out
|-
|T||Tile type: the current tile type/layout
{{pl/Development/NewGRF/ottdp|no|}} In TTDPatch this information is only available during callback 14 (and via variable 10 during callback 24).
|-
|N||Total number of platforms
|-
|L||Total platform length
|-
|c||Platform number current being drawn, counted from the end (starting at zero)
|-
|C||Platform number currently being drawn (starting from zero)
|-
|p||Position along this platform counted from the end, zero at the end
|-
|P||Position along this platform, zero at the beginning
|}

Tutaj "początek" <small>''(beginning)''</small> stacji jest jej najbardziej wysuniętą na północ płytką (w górę na ekranie), a "koniec" <small>''(end)''</small> to płytka najbardziej wysunięta na południe (w dół na ekranie). Każda zmienna składa się z 4 bitów.

Dla zmiennych 46 i 47 pozycja jest liczona od środka, tj. Środkowa płytka ma C=0 and P=0 . W przypadku parzystych długości i liczby platform środkowa płytka znajduje się w pozycji L/2 lub. N/2, np. dla długości 6 jest to płytka 3, która jest czwartą płytką. Format zwracany to xTNLxxCP, gdzie T, N i L są takie jak powyżej, a C i P są pozycjami liczonymi od środka.

Ponieważ C i P mogą mieć liczby ujemne, oto jak jest to zakodowane:

{| |-
!Hex!!Binary!!Decimal
|-
|0||0000||0
|-
|1||0001||1
|-
|7||0111||7
|-
|8||1000||-8
|-
|9||1001||-7
|-
|E||1110||-2
|-
|F||1111||-1
|}

Liczenie przebiega w ten sposób, preferując dodatkową liczbę ujemną dla liczby parzystej (ponieważ dostępnych jest 8 liczb ujemnych, ale tylko 7 dodatnich):

{| |-
!Count!!Numbers
|-
|1||<pre>          0</pre>
|-
|2||<pre>      -1  0</pre>
|-
|3||<pre>      -1  0  1</pre>
|-
|4||<pre>   -2 -1  0  1</pre>
|-
|5||<pre>   -2 -1  0  1  2</pre>
|-
|6||<pre>-3 -2 -1  0  1  2</pre>
|}

(etc.)

=== Terrain and track type (42) ===

Zmienna 42 ma format xxxxttTT, gdzie TT jest typem terenu, a tt jest (przetłumaczonym) typem toru kolejowego.

Mogą mieć następujące wartości:

{| |-
!TT!!Meaning
|-
|0||normal (grass)
|-
|1||desert
|-
|2||rainforest
|-
|4||on or above snowline
|}


Jeśli w GRF nie ma tabeli translacji typów szyn, używana jest domyślna tabela translacji:
{| |-
!tt!!Meaning
|-
|00||railroad, regular
|-
|01||railroad, electrified
|-
|02||monorail
|-
|03||maglev
|}

Jeśli typ szyny nie jest obecny w tabeli, tt zwraca FF.

=== Path-based signalling info (44) ===

Zwraca to następującą wartość w bitach 0-2: (bit 2 dostępny tylko od wersji alfa 47)

{| |-
!State!!Value (binary)!!Value (decimal)
|-
|Reserved||111||7
|-
|Not reserved||100||4
|-
|No PBS||010||2
|}

W tej chwili włączanie/wyłączanie PBS odnosi się do ustawienia przełącznika, w przyszłej wersji alfa będzie faktycznie dotyczyło tego, czy przełącznik jest włączony ''i'' czy bieżący blok faktycznie używa PBS.

Bity są zdefiniowane w ten sposób, aby umożliwić łatwy powrót do przypadków innych niż PBS. Jeśli potrzebujesz grafiki, aby pokazać stan "niezarezerwowany" <small>''(unreserved)''</small> w przypadkach innych niż PBS, użyj bitu 0, ale jeśli potrzebujesz stanu "zarezerwowanego" w przypadkach innych niż PBS, użyj bitu 1. Aby wyraźnie sprawdzić, czy PBS jest aktywny, czy nie, użyj bitu 2.

Wszystkie pozostałe bity są zastrzeżone i muszą być zamaskowane.

=== Rail continuation info (45) ===

Ta zmienna zwraca 16 bitów informacji, czy tory kolejowe kontynuują na ośmiu płytkach sąsiadujących z płytką stacji.

{| |-
!Bit!!Value!!Set if rail continues in direction of...
|-
|0||01||+Length
|-
|1||02||-Length
|-
|2||04||+Platforms
|-
|3||08||-Platforms
|-
|4||10||+Length, +Platforms
|-
|5||20||-Length, +Platforms
|-
|6||40||+Length, -Platforms
|-
|7||80||-Length, -Platforms
|}

Poniższy rysunek ilustruje, które bity reprezentują, który kafelek dla dwóch możliwych orientacji stacji:

<!--[[File:station_var45.png]]-->[http://newgrf-specs.tt-wiki.net/wiki/File:station_var45.png File:station_var45.png]

Bity od 0 do 3 są ustawiane, jeśli na danym kafelku znajduje się ślad i ma on połączenie z kafelkiem stacji. W przypadku bitów 2, 3 stacja oczywiście nie ma połączenia z tymi kafelkami, ale nie ma to znaczenia dla tej zmiennej. Bity 4 do 7 sprawdzają połączenia z sąsiadującą płytką platformy, tj. Bity 4 i 5 odpowiednio. 6 i 7 wskazują połączenie z tego kafelka do kafelka 2 lub odpowiednio. 3. (Zmieniło się to ponownie w wersji 2.5 beta 4 r325.)

Bity 8..15 powtarzają powyższe, ale są ustawiane, jeśli na kafelku są jakieś tory kolejowe i ignorowane, czy tor jest podłączony do stacji, czy nie w całości.

=== Animation frame of nearby tile (66) ===

(Od TTDPatch 2.5 beta 5)

Ten parametr określa przesunięcie względem bieżącego kafelka. Obie wartości są uważane za podpisane (to znaczy 8h=-8, 9h=-7, ...., Fh=-1, 0h=0, 1h=1, ..., 7h=7 ). Wysoki kęs zawiera ilość ruchu na boki (między platformami), niski to ilość poruszania się po platformie. Przesunięcia ujemne przesuwają się na północ, a dodatnie na południe. Jeśli wybrany kafelek jest kafelkiem stacji kolejowej należącym do bieżącej stacji, zwracany jest jego stan animacji. W przeciwnym razie zwracany jest FFFFFFFFh.

=== Land info of nearby tiles (67) ===

Ta zmienna działa jak [[pl/Development/NewGRF/NFO Specs/VariationalAction2/Industry Tiles#land-info-of-nearby-tiles-60|industry tile variable 60]] , z wyjątkiem trzech rzeczy:
* Przesunięcia <small>''(offsets)''</small> parametru są interpretowane w odniesieniu do wyrównania stacji, w taki sam sposób jak dla zmiennej 66
* Część '''ss''' jest "dublowana" <small>''~mirrored''</small> (bit 0 i 2 zamienione) dla orientacji NW-SE; pozwoli to na obsługę analogicznych nachyleń dwóch orientacji bez wyraźnego sprawdzania orientacji (od TTDPatch 2.6 r1693)
* Bit 0 częśc  '''bb''' jest niezdefiniowany

=== Station info of nearby tiles (68) ===

Parametr tej zmiennej działa tak samo jak parametr zmiennej 66. Zwrócona wartość to FFFFFFFFh, jeśli wybrana płytka nie jest płytką stacji kolejowej. W przeciwnym razie zwróconą wartość można podzielić na następujące części:

{| |-
!Bits!!Meaning
|-
|0..7||If the tile is defined in the current GRF, this is the setID used in the definition. Otherwise, the content is undefined.
|-
|8..9||0 - the tile uses original TTD graphics

1 - the tile is defined in the current GRF

2 - the tile is defined in another GRF
|-
|10||set if the selected tile belongs to the current station, clear otherwise
|-
|11||clear if the selected tile is parallel with the current one, set if perpendicular to it
|-
|12..13||0 - plain platform

1 - platform with building

2 - platform with roof, left side

3 - platform with roof, right side
|-
|14..31||Undefined, reserved for future use
|}

=== GRFID of nearby station tile (6A) ===

Parametr tej zmiennej działa w taki sam sposób, jak parametr zmiennej 66.
Zwrócona wartość jest jedną z następujących czynności:
* '''FFFFFFFFh''' jeśli wybrany kafelek nie jest kafelkiem stacji
* '''00000000h''' jeśli wybrana stacja jest stacją domyślną (brak stacji NewGRF)
* w przeciwnym razie GRFID GRF, który zdefiniował typ wybranej stacji

==Przykład==