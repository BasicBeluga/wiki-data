[[Translation:en/Manual/Dedicated server]]


{{zh/翻译|origin=en/Manual/Dedicated server
|from=en
|to=zh
|Percentage=0
}}

[[File:en/Manual/Dedicated server.png|right|frame|专用服务器窗口D]]
'''专用服务器'''是一个没有本地客户端加入的 OpenTTD 网络[[zh/Manual/服务器]]。专用服务器可以在计算机后台运行。

==启动专用服务器==
用[[en/Manual/Command line | 命令行选项(en)]] {{en/C|-D|}} （大写的 D！）启动 OpenTTD 可执行文件。

===在 Windows===
方法 1:
*创建一个到 {{en/C|openttd.exe|}} 的快捷方式
*右键点击快捷方式，点击属性
*在目标一栏末尾添加 {{en/C|-D|}}
*点击应用
*运行快捷方式

方法 2:
*在开始菜单点击运行（按 Win键+R 组合键也可以）
*输入：{{en/C|"c:\(到OpenTTD游戏文件夹的路径)\openttd.exe" -D|}}
*点击确定

===在 Linux===
*在终端运行 {{en/C|openttd -D|}} 。如果你通过 SSH 连接到服务器，并且希望游戏在你注销时继续运行，可使用 [http://www.gnu.org/software/screen/ GNU Screen] 或者 [http://dtach.sourceforge.net/ dtach]。

你也可以用 -f 选项启动 OpenTTD ，此时进程会在后台运行，但没有控制台可用。所有的日志都会被写入 openttd.log 文件。你可以用 tail 命令查看该文件以跟踪事件：'''tail -f openttd.log''' 。

===在 OS/2===
*运行 {{en/C|dedicated.cmd|}} 文件。因为如果你运行 {{en/C|openttd -D|}} 的话你就看不到控制台窗口，不能为程序提供命令。

===在 Mac OS X===
*打开终端。
*用 cd 切换到包含 OpenTTD 的目录
*输入 '''cd OpenTTD.app/Contents/MacOS/'''
*输入 '''./openttd -D'''
*OpenTTD 此时应该启动为专用服务器

===在 Docker.io ===
* 查阅 https://registry.hub.docker.com/r/bateau/openttd/ 以获得更多详情。

==配置服务器==
有 3 种方式修改游戏设置：
*启动一个单人游戏，修改设置，然后关闭游戏。
*使用[[en/Manual/Console#server-commands|控制台指令(en)]]在服务器运行时修改设置。
*手动编辑 [[en/Archive/Manual/Settings/Openttd.cfg]] 文件。查阅 [[en/Archive/Manual/Settings/Diff custom]] 以获取帮助。
可用工具:
*[http://www.tt-forums.net/viewtopic.php?f=29&t=33967 Web Interface]
*[http://olex.biz/en/software/spiele/openttd-webconfig OpenTTD WebConfig]

修改 [[en/Archive/Manual/Settings/Openttd.cfg]] 中的 Network 部分来更改网络设置：
*将 [[en/Archive/Manual/Settings/Lan internet]] 设置为 0 。
*修改服务器名称 [[en/Archive/Manual/Settings/Server name]] 使玩家辨认服务器。 
*将 [[en/Archive/Manual/Settings/Server advertise]] 设置为 true，使其在服务器列表可见。
*如果你有多个网络接口，请确认你设置了 [[en/Archive/Manual/Settings/Server bind ip]]。
*如果你处于路由器内网中，请确保你用 [[en/Archive/Manual/Settings/Server port]] 设置了转发端口（TCP 和 UDP）。

==用rcon控制服务器==
配置专用服务器接受 [[zh/Manual/控制台|rcon]]命令：
*在专用服务器窗口输入 {{en/C|rcon_pw <密码>|}}。
:比如：{{en/C|rcon_pw x8na7f|}}

用客户端连接服务器：
*正常启动 OpenTTD。
*在服务器列表找到你的服务器并连接。
*打开控制台（按 ~ 键）
*输入 {{en/C|rcon <密码> "<命令>"|}}. 
:比如: {{en/C|rcon x8na7f "kick 5"|}}

==安装在线内容==
If you want to install content using the in-game content download facility, you can do that from the console in your dedicated server. The benefit of using this compared to copying the files manually to your server is that it will automatically get all dependencies that the content author has declared when uploading it to the content system.

*First, you need to load the list of available content from the content server:
:{{en/C|content update|}}
:Wait until "Content server connection closed" is printed in the console.

*List all available content
:{{en/C|content state|}}
:A list of available content is now printed. Find the content you like to download and read its ID which is written in the beginning of the line. Eg. 2947 for Simple City Builder.

*Next, select the content to download using its id:
:{{en/C|content select 2947|}}

*You can add more content by repeating the {{en/C|content select|}} command.

*Then download all selected content:
:{{en/C|content download|}}

Hint: If you use nightly r26000+ or stable 1.4+, you can type {{en/C|content state city|}} to only list content that contain the word 'city' in their name.

==加载游戏==
In the dedicated server window (or with rcon):
*Type {{en/C|ls|}} to list the files of the current directory, a number will be beside each one, which represents {{en/C|<number>|}} below.
*Type {{en/C|cd <number>|}} to go to that directory.
*Type {{en/C|load <number>|}} to load that file.

*You can also load savegames and scenarios with the {{en/C|-g "<filename>"|}}, command line option. 
:Example: {{en/C|openttd.exe -D -g "scenario/echo.scn"|}}.

==自动启动/停止服务器并保存游戏==
If you do not want to run docker: Run your dedicated server in ubuntu/debian you can download and install a init.d script
You will get the following functions:
* Automatically startup when your server box bootup
* Automatically shutdown when you server box is shutdown
* Automatically saving your game at a defined interval
For more functions, install guide and download, visit: https://bitbucket.org/frodus/openttd-init

With a ready-made docker container you get a tested and working environment for openttd.
In ubuntu 14.04 or newer you can run: sudo apt-get install docker.io and then read documentation on the following url
https://registry.hub.docker.com/r/bateau/openttd/
Mind that this is a pre-configured virtual machine and packaging is done by 3rd party.


==另请参见==
*[[en/Archive/Manual/Settings/Autoclean companies|Autoclean companies]]   in order to specify what happens when a player logs off during a game and a company becomes inactive
*A short intro on Firewalls for  Dedicated Servers [http://www.uk2.net/blog/why-is-a-firewall-important-for-your-dedicated-server-2/]

[[Category:zh/Manual/多人游戏]]
[[Category:zh/Manual/教程]]